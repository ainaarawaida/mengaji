var $=jQuery.noConflict(),ST_WC_FRONT_SWATCH=ST_WC_FRONT_SWATCH||{},ST_WC_Triggered_variations=[];!function(h){"use strict";ST_WC_FRONT_SWATCH.onSelect=function(){h("body").on("click","ul.st-swatch-preview span.st-custom-attribute",function(){if(!h(this).parents().is(".swiper-entry, .products-loop, .et-quick-view-wrapper")){var t=h(this).closest("[data-attribute]").data("attribute"),e=h("select#"+t),a=h(this).data("value"),t=h(this).parent("li");if(null!=a&&!e.find('option[value="'+a+'"]').length)return e.val(" ").trigger("change"),t.siblings().removeClass("selected"),void window.alert(sten_wc_params.i18n_no_matching_variations_text);t.hasClass("selected")?(t.removeClass("selected"),e.val(" "),1==sten_wc_params.is_singular_product&&sten_wc_params.is_customize_preview&&t.css({"border-color":t.data("border-color")})):(t.addClass("selected").siblings().removeClass("selected"),e.val(a),1==sten_wc_params.is_singular_product&&sten_wc_params.is_customize_preview&&(t.removeAttr("style"),t.siblings().css({"border-color":t.data("border-color")}),t.css({"border-color":t.data("active-border-color")}))),e.trigger("change")}})},ST_WC_FRONT_SWATCH.onSelectUpdateAttribute=function(){h("body.single-product form.variations_form").on("woocommerce_update_variation_values",function(){h(this).find("ul.st-swatch-preview").each(function(){var t=h(this).data("attribute"),e=document.getElementById(t),a=h(e).find("option"),s=h(e).find("option").eq(1),t=h(this).find("li"),i=h(e).find("option:selected"),r=[],o="";a.each(function(){""!==h(this).val()&&(r.push(h(this).val()),o=(i||s).val())}),t.each(function(){var t=this,e=h(t).find("span.st-custom-attribute").attr("data-value");h(t).removeClass("selected sten-li-disabled").addClass("sten-li-disabled"),-1!==r.indexOf(e.toString())&&(h(t).removeClass("sten-li-disabled"),e.toString()==o&&h(t).addClass("selected"))})})})},ST_WC_FRONT_SWATCH.onClear=function(){h("body.single-product").on("click","a.reset_variations",function(){var t=h(this).closest("form.variations_form").find("ul.st-swatch-preview li.selected");t.removeClass("selected"),1==sten_wc_params.is_singular_product&&sten_wc_params.is_customize_preview&&t.css({"border-color":t.data("border-color")})})},ST_WC_FRONT_SWATCH.productLoop={init:function(){ST_WC_FRONT_SWATCH.productLoop.itemSwatches(),ST_WC_FRONT_SWATCH.productLoop.addToCart(),ST_WC_FRONT_SWATCH.productLoop.showMoreAttr()},itemSwatches:function(){h("div.st-swatch-in-loop").each(function(){var s=h(this),t=s.find("span.st-custom-attribute:not(.sten-disabled)"),a=s.find("a.sten-reset-loop-variation, .et-delete"),i=s.closest(".product-type-variable"),r=h.parseJSON(s.attr("data-product_variations")),e=s.find("ul.has-default-attribute");i.find("a.add_to_cart_button").addClass("et-st-disabled"),h(".st-swatch-btn-ready").removeClass("et-st-disabled"),ST_WC_FRONT_SWATCH.productLoop.updateAttributes(s,r),e.each(function(){var t=h(this).parent("div.st-swatch-in-loop").find("a.sten-reset-loop-variation");t.show();var e=ST_WC_FRONT_SWATCH.productLoop.getChosenAttributes(s),a=e.data;e.count===e.chosenCount?(ST_WC_FRONT_SWATCH.productLoop.updateAttributes(s,r),(a=ST_WC_FRONT_SWATCH.productLoop.findMatchingVariations(r,a).shift())?ST_WC_FRONT_SWATCH.productLoop.foundVariation(i,s,a):t.trigger("click")):ST_WC_FRONT_SWATCH.productLoop.updateAttributes(s,r)}),t.on("click",function(){var t=h(this),e=t.parent("li");if(t.hasClass("sten-disabled"))return!1;i.find("span.st-custom-attribute").removeClass("sten-disabled sten-enabled"),i.find("span.st-custom-attribute").parent("li").removeClass("sten-li-disabled sten-li-enabled"),e.hasClass("selected")&&sten_wc_params.is_customize_preview&&e.css({"border-color":e.data("border-color")}),e.hasClass("selected")||(e.addClass("selected").siblings().removeClass("selected"),sten_wc_params.is_customize_preview&&(e.removeAttr("style"),e.siblings().css({"border-color":e.data("border-color")}),e.css({"border-color":e.data("active-border-color")})),a.slideDown());t=ST_WC_FRONT_SWATCH.productLoop.getChosenAttributes(s),e=t.data;t.count===t.chosenCount?(ST_WC_FRONT_SWATCH.productLoop.updateAttributes(s,r),(e=ST_WC_FRONT_SWATCH.productLoop.findMatchingVariations(r,e).shift())?ST_WC_FRONT_SWATCH.productLoop.foundVariation(i,s,e):a.trigger("click")):ST_WC_FRONT_SWATCH.productLoop.updateAttributes(s,r)}),a.on("click",function(){s.removeAttr("data-variation_id"),sten_wc_params.is_customize_preview&&(e=s.find("ul.st-swatch-preview li.selected")).css({"border-color":e.data("border-color")}),s.find("ul.st-swatch-preview li").removeClass("selected sten-li-disabled sten-li-enabled"),s.find("ul.st-swatch-preview span").removeClass("sten-disabled sten-enabled"),i.find("a.add_to_cart_button").addClass("et-st-disabled").removeClass("st-swatch-btn-ready st-swatch-btn-readmore st-swatch-btn-text-changed added loading").text(sten_wc_params.select_options_btn_text).attr("aria-label",sten_wc_params.select_options_btn_text+" "+sten_wc_params.read_more_for_btn_text+' "'+i.find("a.add_to_cart_button").attr("data-product_name")+'"'),i.find("a.added_to_cart").remove();var t=i.find("span.price").not(".price-cloned"),e=i.find(".price-cloned");e.length&&(t.html(e.html()),e.remove()),r=h.parseJSON(s.attr("data-product_variations")),ST_WC_FRONT_SWATCH.productLoop.updateAttributes(s,r),ST_WC_FRONT_SWATCH.productLoop.variationsImageUpdate(i,!1),h(this).parents().is(".et-quick-view-wrapper")&&(h(this).parents(".et-quick-view-wrapper").find(".price:not(.price_cloned)").remove(),h(this).parents(".et-quick-view-wrapper").find(".price_cloned").removeClass("price_cloned").attr("style",null)),h(this).slideUp()})})},getChosenAttributes:function(t){var a={},s=0,i=0;return t.find("ul.st-swatch-preview").each(function(){var t="attribute_"+h(this).data("attribute"),e=h(this).find("li.selected span.st-custom-attribute").attr("data-value")||"";0<(e=e.toString()).length&&i++,s++,a[t]=e}),{count:s,chosenCount:i,data:a}},updateAttributes:function(t,l){var _,u=ST_WC_FRONT_SWATCH.productLoop.getChosenAttributes(t).data;t.find("ul.st-swatch-preview").each(function(t,e){var a=h(e),s="attribute_"+a.data("attribute"),i=a.find("li.selected span.st-custom-attribute").data("value"),r=!0,e=h.extend(!0,{},u);e[s]="";var o,n=ST_WC_FRONT_SWATCH.productLoop.findMatchingVariations(l,e);for(o in n)if(void 0!==n[o]){var d,c,p=n[o].attributes;for(d in p)p.hasOwnProperty(d)&&(c=p[d],d===s&&(n[o].variation_is_active,(c?a.find('span.st-custom-attribute[data-value="'+c+'"]'):a.find("span.st-custom-attribute")).addClass("sten-enabled")))}_=a.find("span.st-custom-attribute.sten-enabled").length,!i||0!==_&&0!==a.find('span.st-custom-attribute.sten-enabled[data-value="'+ST_WC_FRONT_SWATCH.productLoop.addSlashes(i)+'"]').length||(r=!1),a.find("span.st-custom-attribute:not(.sten-enabled)").addClass("sten-disabled"),a.find("span.st-custom-attribute:not(.sten-enabled)").parent("li").addClass("sten-li-disabled"),i&&r||a.find("li.selected").removeClass("selected")})},findMatchingVariations:function(t,e){for(var a=[],s=0;s<t.length;s++){var i=t[s];ST_WC_FRONT_SWATCH.productLoop.isMatch(i.attributes,e)&&a.push(i)}return a},isMatch:function(t,e){var a,s,i,r=!0;for(a in t)t.hasOwnProperty(a)&&(s=t[a],i=e[a],null!=s&&null!=i&&0!==s.length&&0!==i.length&&s!==i&&(r=!1));return r},foundVariation:function(t,e,a){var s=t.find("span.price").not(".price-cloned"),i=s.clone().addClass("price-cloned").css("display","none");e.attr("data-variation_id",a.variation_id),a.price_html?(t.find(".price-cloned").length||t.append(i),s.replaceWith(a.price_html)):t.find(".price-cloned").length&&(s.replaceWith(i.html()),i.remove()),etConfig.woocommerceSettings.wishlist_for_variations&&e.trigger("found_variation",[a]),ST_WC_FRONT_SWATCH.productLoop.variationsImageUpdate(t,a),ST_WC_FRONT_SWATCH.productLoop.changeAddToCartBtnText(t,a)},variationsQuickViewUpdate:function(t,e){let a=h(".et-quick-view-wrapper");a.find(".stock").remove(),e.availability_html&&a.find(".st-swatch-in-loop").before(e.availability_html);let s=a.find(".sku_wrapper .sku");e.sku?(s.attr("data-o_content")||s.attr("data-o_content",s.html()),s.html(e.sku)):s.html(s.attr("data-o_content")),ST_WC_FRONT_SWATCH.productLoop.variationsLoopQty(t,e,a.find("input.qty"))},variationsLoopQty:function(t,e,a){a.length&&e.is_in_stock&&e.max_qty&&(a.attr("min",e.min_qty),a.attr("max",e.max_qty),e.max_qty<a.val()&&a.parent().find(".plus").trigger("click"))},variationsQuickViewQty:function(){let a=h(".et-quick-view-wrapper"),s=a.find("input.qty");s.length&&(s.attr("min",1),s.on("change",function(t){let e=s.val();0==e&&(e=1),a.find("a.button.product_type_variable").attr("data-quantity",e)}))},variationsImageUpdate:function(t,e){var a,s,i=t.find("img.wp-post-image, img.attachment-woocommerce_thumbnail, img.attachment-shop_catalog"),r=t.find(".st-swatch-in-loop");r.parents().is(".et-quick-view-wrapper")?(ST_WC_FRONT_SWATCH.productLoop.variationsQuickViewUpdate(t,e),r.parents(".et-quick-view-wrapper").find(".price_cloned").length<1&&(a=r.parents(".et-quick-view-wrapper").find("p.price:not(.price_cloned)")).after(a.clone().addClass("price_cloned").hide()),e.price_html&&r.parents(".et-quick-view-wrapper").find("p.price:not(.price_cloned)").html(e.price_html)):ST_WC_FRONT_SWATCH.productLoop.variationsLoopQty(t,e,t.find("input.qty")),r.parents().is(".et-quick-view-wrapper")&&e&&e.st_image_src&&e.image.src&&1<e.st_image_src.length?(ST_WC_FRONT_SWATCH.productLoop.setVariationAttr(i,"src",e.image.full_src),i.attr("srcset")&&ST_WC_FRONT_SWATCH.productLoop.setVariationAttr(i,"srcset",e.image.full_src),ST_WC_FRONT_SWATCH.productLoop.setVariationAttr(i,"sizes",e.sizes)):e&&e.st_image_src&&e.image.src&&1<e.st_image_src.length?(i.parents().is(".product-image-wrapper")&&((s=h(i).parents(".product-image-wrapper")).find(".product-content-image"),r.is(".st-swatch-popup")||s.addClass("variation-changed")),ST_WC_FRONT_SWATCH.productLoop.setVariationAttr(i,"src",e.st_image_src[0]),i.attr("srcset")&&ST_WC_FRONT_SWATCH.productLoop.setVariationAttr(i,"srcset",e.st_image_srcset),ST_WC_FRONT_SWATCH.productLoop.setVariationAttr(i,"sizes",e.st_image_sizes)):(i.parents().is(".product-image-wrapper")&&((s=h(i).parents(".product-image-wrapper")).find(".product-content-image"),r.is(".st-swatch-popup")||s.removeClass("variation-changed")),ST_WC_FRONT_SWATCH.productLoop.resetVariationAttr(i,"src"),i.attr("srcset")&&ST_WC_FRONT_SWATCH.productLoop.resetVariationAttr(i,"srcset"),ST_WC_FRONT_SWATCH.productLoop.resetVariationAttr(i,"sizes"))},changeAddToCartBtnText:function(t,e){var a=t.find("a.add_to_cart_button"),s="",i="";a.removeClass("added"),Object.keys(e.attributes).length===t.find("ul.st-swatch-preview").length?!0===e.is_in_stock?(s=sten_wc_params.add_to_cart_btn_text,i=sten_wc_params.add_to_cart_btn_text,a.addClass("st-swatch-btn-ready").removeClass("st-swatch-btn-readmore").removeClass("et-st-disabled")):(s=sten_wc_params.read_more_btn_text,i=sten_wc_params.read_more_btn_text,i+=" "+sten_wc_params.read_more_about_btn_text,a.addClass("st-swatch-btn-readmore et-st-disabled").removeClass("st-swatch-btn-ready")):(s=sten_wc_params.select_options_btn_text,i=sten_wc_params.select_options_btn_text,i+=" "+sten_wc_params.read_more_for_btn_text,a.removeClass("st-swatch-btn-ready st-swatch-btn-readmore et-st-disabled")),i+=' "'+a.attr("data-product_name")+'"',a.attr("aria-label",i),a.addClass("st-swatch-btn-text-changed").text(s);let r=t.find("a.add_to_cart_button.et_product_variable-in-quick-view");r.length&&e.is_in_stock&&r.text(r.attr("data-text"))},setVariationAttr:function(t,e,a){void 0===t.attr("data-o_"+e)&&t.attr("data-o_"+e,t.attr(e)?t.attr(e):""),!1===a?t.removeAttr(e):t.attr(e,a)},resetVariationAttr:function(t,e){t.parents(".content-product, .product-content").find(".et-out-of-stock").removeClass("et-out-of-stock"),void 0!==t.attr("data-o_"+e)&&t.attr(e,t.attr("data-o_"+e)),t&&t.hasClass("lazyloaded")&&(t.removeClass("lazyloaded").addClass("lazyload"),etTheme.global_image_lazy())},addSlashes:function(t){return t=(t=(t=t.toString()).replace(/'/g,"\\'")).replace(/"/g,'\\"')},addToCart:function(){etConfig.woocommerceSettings.is_smart_addtocart&&h(document).on("click",".et-st-disabled",function(t){t.preventDefault()}),h(document).on("click","a.product_type_variable.add_to_cart_button.st-swatch-btn-ready",function(t){t.preventDefault();var a=h(this),e=a.closest(".product-type-variable").find("div.st-swatch-in-loop"),s=e.attr("data-variation_id");if(void 0===s||""==s)return!0;var i=a.data("product_id"),r=a.attr("data-quantity"),o={};e.find("ul.st-swatch-preview").each(function(){var t=h(this).data("attribute"),e=h(this).find("li.selected span").data("value");o["attribute_"+t]=e}),a.removeClass("added"),a.addClass("loading");s={action:"sten_wc_product_loop_add_to_cart",product_id:i,quantity:r,variation_id:s,variation:o};h("body").trigger("adding_to_cart",[a,s]),h.ajax({type:"POST",url:sten_wc_params.ajax_url,data:s,success:function(t){if(!t)return!1;if(t.error&&t.product_url)return window.location=t.product_url,!1;var e=t.fragments,t=t.cart_hash;return e&&h.each(e,function(t,e){h(t).replaceWith(e)}),h(".quick-view-popup .mfp-close, .et-quick-view-canvas .et-close-popup").trigger("click"),a.addClass("added"),h("body").trigger("added_to_cart",[e,t,a]),a.parents(".product-type-variable").find(".st-swatch-in-loop .et-delete").trigger("click"),a.hasClass("et_product_variable-in-quick-view")&&a.attr("data-redirect")?(window.location=a.attr("data-redirect"),!1):void 0},error:function(t){console.log(t)}}),t.preventDefault()})},showMoreAttr:function(){h(document).on("click",".et_show-more-attr",function(){var t=h(this).parents(".st-swatch-in-loop");t.find("ul.st-swatch-preview li.hidden:not(.et_show-more-attr)").removeClass("hidden"),t.find("ul.st-swatch-preview li.et_show-more-attr").addClass("hidden")})}},ST_WC_FRONT_SWATCH.documentOnReady={init:function(){ST_WC_FRONT_SWATCH.onSelect(),ST_WC_FRONT_SWATCH.onClear(),ST_WC_FRONT_SWATCH.onSelectUpdateAttribute(),ST_WC_FRONT_SWATCH.productLoop.init()},ET_In_Popup:function(){h(document).on("click",".st-swatch-et-disabled li span",function(t){var e,a,s;h(this).parents().is(".et-quick-view-wrapper")||(a=(e=h(this).parents(".st-swatch-in-loop")).parents(".content-product"),e.addClass("active"),h(this).parents(".product-details").addClass("st-swatch-popup-active"),h.each(e.closest("div").find("div.et_st-default-holder"),function(){var t=h(this).html();t=(t=t.replace("st-swatch-size-small","st-swatch-size-normal")).replace("st-swatch-et-disabled","st-swatch-et-anabled"),h(this).parents(".st-swatch-in-loop").find(".st-swatch-preview-wrap .et_st-popup-holder").append(t)}),s=e.find("div.et_st-default-holder").height(),e.find("div.et_st-default-holder").css("min-height",s),e.find("div.et_st-default-holder ul").remove(),e.find(".sten-reset-loop-variation").remove(),a.find(".product-image-wrapper").is(".variation-changed")||a.find(".product-image-wrapper").addClass("variation-changed"),ST_WC_FRONT_SWATCH.productLoop.itemSwatches())}),h(document).on("click",".st-swatch-in-loop .et-delete",function(t){var e;h(this).parents().is(".et-quick-view-wrapper")||(e=h(this).parents(".st-swatch-in-loop").parents(".content-product"),h.each(h(this).parents(".st-swatch-in-loop").find("div.st-swatch-preview-wrap .et_st-popup-holder ul"),function(){var t=h(this).removeClass("st-swatch-et-anabled").addClass("st-swatch-et-disabled"),e=h(this).data("attribute");h(this).parents(".st-swatch-in-loop").find('div.et_st-default-holder[data-et-holder="'+e+'"]').prepend(t)}),h(this).parents(".st-swatch-in-loop").removeClass("active"),h(this).parents(".product-details").removeClass("st-swatch-popup-active"),h(this).parents(".st-swatch-in-loop").find(".st-swatch-preview-wrap .et_st-popup-holder ul").remove(),e.find(".product-image-wrapper").is(".variation-changed")&&e.find(".product-image-wrapper").removeClass("variation-changed"),ST_WC_FRONT_SWATCH.productLoop.itemSwatches())})}},h(document).ready(ST_WC_FRONT_SWATCH.documentOnReady.init),h(document).ready(ST_WC_FRONT_SWATCH.documentOnReady.ET_In_Popup)}(jQuery);